// Adds fuel switching between Lithium and Lithium6 for Near Future Propulsions lithium tanks. Needs B9Partswitch, CommunityResourcePack, ModuleManager, RationalResources, RationalResourcesCompanion, and RationalResourcesSquad
@PART[lithium-*-*]:HAS[@RESOURCE[Lithium],!MODULE[InterstellarFuelSwitch],!MODULE[ModuleEnginesFX],!MODULE[ModuleEngines],!MODULE[FSfuelSwitch],!MODULE[WBIConvertibleStorage],!MODULE[WBIResourceSwitcher],!MODULE[WBIOmniStorage]]:NEEDS[!ModularFuelTanks&!RealFuels]:AFTER[RationalResourcesSquad]
{
	// THIS PATHCING COMES FROMCRYOTANKS BY NERTEA, THIS IS NOT COMPLETELY MY OWN.
	//Calculate total capacity by units of default resources
	%LI = #$RESOURCE[Lithium]/maxAmount$

	%totalCap = #$RESOURCE[Lithium]/maxAmount$

	//Mass offset is used to ensure correct dry mass of tanks
	%massOffset = #$totalCap$
	@massOffset *= 0.000178 // tank mass per unit Lithium
	@massOffset *= -1

	//Take default resource quantities and multiply by resource units costs to calculate total cost of original resources
	@LI *= #$@RESOURCE_DEFINITION[Lithium]/unitCost$

	//Sum the total costs of both resources and deduct to avoid double counting once resources are added via switcher
	%costOffset = #$LI$
	@costOffset *= -1

	//remove original resource
	!RESOURCE[Lithium] {}
	!MODULE[ModuleB9PartSwitch]:HAS[#moduleID[fuelSwitch]] {}
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = fuelSwitch
		switcherDescription = #LOC_CryoTanks_switcher_fuel_title
		baseVolume = #$../totalCap$
		SUBTYPE
		{
			name = zCP_Lithium
			title = Lithium
			primaryColor = BrownishRed
			secondaryColor = BrownishRed
			tankType = RR_Lithium
			addedMass = #$../../massOffset$
			addedCost = #$../../costOffset$
		}
		SUBTYPE
		{
			name = zCP_Lithium6
			title = Lithium6
			primaryColor = ReddyBrown
			secondaryColor = ReddyBrown
			tankType = zCP_Lithium6
			addedMass = #$../../massOffset$
			addedCost = #$../../costOffset$
		}
	}
}
